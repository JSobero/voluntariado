<div class="page-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-left">
      <h1 class="page-title">
        <span class="title-icon">📅</span>
        Gestión de Eventos
      </h1>
      <p class="page-subtitle">Administra todos los eventos de voluntariado</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="openModal()">
        <span class="btn-icon">➕</span>
        Nuevo Evento
      </button>
    </div>
  </div>

  <!-- Search & Filters -->
  <div class="filters-section">
    <div class="search-container">
      <span class="search-icon">🔍</span>
      <input
        type="text"
        class="search-input"
        placeholder="Buscar eventos por título, descripción o lugar..."
        [(ngModel)]="searchTerm"
        (ngModelChange)="filterEventos()">
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando eventos...</p>
  </div>

  <!-- Events Table -->
  <div *ngIf="!loading" class="table-card">
    <div class="table-responsive">
      <table class="data-table">
        <thead>
        <tr>
          <th>ID</th>
          <th>Evento</th>
          <th>Fecha Inicio</th>
          <th>Lugar</th>
          <th>Cupo</th>
          <th>Estado</th>
          <th>Organizador</th>
          <th>Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let evento of filteredEventos" class="table-row">
          <td class="id-cell">
            <span class="id-badge">{{ evento.id }}</span>
          </td>
          <td class="evento-cell">
            <div class="evento-info">
              <span class="evento-icon">📅</span>
              <div>
                <div class="evento-title">{{ evento.titulo }}</div>
                <div class="evento-description">{{ evento.descripcion }}</div>
              </div>
            </div>
          </td>
          <td class="date-cell">
            <div class="date-wrapper">
              <span class="date-icon">🗓️</span>
              <span>{{ evento.fechaInicio | date:'dd/MM/yyyy' }}</span>
            </div>
            <div class="time-wrapper">
              <span class="time-icon">🕐</span>
              <span>{{ evento.fechaInicio | date:'HH:mm' }}</span>
            </div>
          </td>
          <td class="location-cell">
            <div class="location-wrapper">
              <span class="location-icon">📍</span>
              <span>{{ evento.lugar }}</span>
            </div>
          </td>
          <td class="capacity-cell">
              <span class="capacity-badge">
                {{ evento.cupoMaximo }} personas
              </span>
          </td>
          <td class="status-cell">
              <span [ngClass]="getEventoStatusClass(evento.fechaInicio)" class="status-badge">
                {{ getEventoStatus(evento.fechaInicio) }}
              </span>
          </td>
          <td class="organizer-cell">
            <div class="organizer-info">
              <div class="organizer-avatar">
                {{ evento.organizador.nombre.charAt(0) }}
              </div>
              <span>{{ evento.organizador.nombre }}</span>
            </div>
          </td>
          <td class="actions-cell">
            <button class="btn-action btn-edit" (click)="openModal(evento)" title="Editar">
              ✏️
            </button>
            <button class="btn-action btn-delete" (click)="deleteEvento(evento.id!)" title="Eliminar">
              🗑️
            </button>
          </td>
        </tr>
        </tbody>
      </table>

      <!-- Empty State -->
      <div *ngIf="filteredEventos.length === 0" class="empty-state">
        <div class="empty-icon">📅</div>
        <h3>No se encontraron eventos</h3>
        <p>Intenta con otros términos de búsqueda o crea un nuevo evento</p>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <!-- Modal Header -->
      <div class="modal-header">
        <h2 class="modal-title">
          <span class="modal-icon">{{ editMode ? '✏️' : '➕' }}</span>
          {{ editMode ? 'Editar Evento' : 'Nuevo Evento' }}
        </h2>
        <button class="modal-close" (click)="closeModal()">✕</button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">
            <span class="label-text">Título</span>
            <span class="label-required">*</span>
          </label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="currentEvento.titulo"
            placeholder="Ej: Limpieza de playas"
            required>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-text">Descripción</span>
          </label>
          <textarea
            class="form-textarea"
            [(ngModel)]="currentEvento.descripcion"
            rows="3"
            placeholder="Describe el evento..."></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              <span class="label-text">Fecha Inicio</span>
              <span class="label-required">*</span>
            </label>
            <input
              type="datetime-local"
              class="form-input"
              [(ngModel)]="currentEvento.fechaInicio"
              required>
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-text">Fecha Fin</span>
            </label>
            <input
              type="datetime-local"
              class="form-input"
              [(ngModel)]="currentEvento.fechaFin">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-text">Lugar</span>
            <span class="label-required">*</span>
          </label>
          <input
            type="text"
            class="form-input"
            [(ngModel)]="currentEvento.lugar"
            placeholder="Ej: Playa Costa Verde, Lima"
            required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              <span class="label-text">Cupo Máximo</span>
              <span class="label-required">*</span>
            </label>
            <input
              type="number"
              class="form-input"
              [(ngModel)]="currentEvento.cupoMaximo"
              min="1"
              placeholder="50"
              required>
          </div>

          <div class="form-group">
            <label class="form-label">
              <span class="label-text">Organizador</span>
              <span class="label-required">*</span>
            </label>
            <select
              class="form-select"
              [(ngModel)]="currentEvento.organizador"
              required>
              <option value="">Seleccionar organizador...</option>
              <option *ngFor="let org of organizadores" [ngValue]="org.id">
                {{ org.nombre }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeModal()">
          Cancelar
        </button>
        <button class="btn btn-primary" (click)="saveEvento()">
          <span class="btn-icon">{{ editMode ? '💾' : '➕' }}</span>
          {{ editMode ? 'Actualizar' : 'Crear' }} Evento
        </button>
      </div>
    </div>
  </div>
</div>
